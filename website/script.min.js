const test=(e,t)=>{const n=new Uint16Array([1940,1939,1940,1939,1940,1939,2397]),i={zoom_out_bounds_rect:void 0,total_stacks:9,stack_y_spacer:2909,zone_highlight_offset:970,standard:{x:0,stack_width:62400,stack_height:14033,bank_width:5200,uniform_bank_width:5200,height:14033,shelf_heights:new Uint16Array([1455,1454,1455,1454,1455,1454,1455,1454,1198,1199]),multiple_shelf_heights:{3:{6:new Uint16Array([1445,979,951,959,1484,1455,1454,1455,1454,1198,1199]),9:new Uint16Array([1461,1009,1140,1126,1137,1455,1454,1455,1454,1198,1199])},4:{5:new Uint16Array([1455,1454,1455,1454,1498,1735,1632,1591,1778])},6:{1:n,2:n,3:n,4:n,5:n,6:n}}},stack_one:{x:5200,stack_height:14033,stack_width:52e3,uniform_bank_width:5200,shelf_heights:new Uint16Array([1455,1454,1455,1454,1455,1454,1455,1454,1198,1199])},ephemera:{x:7800,stack_width:46720,stack_height:14033,shelf_heights:new Uint16Array([1455,1454,1455,1454,1455,1454,1455,1239,1360,1361]),bank_widths:new Uint16Array([5200,5200,5200,5200,3880,3880,3880,3880,5200,5200]),narrow_width:3880},therkelson:{x:23508,stack_width:15424,stack_height:7907,bank_width:3846,uniform_bank_width:3846,shelf_heights:new Uint16Array([1354,1354,1354,1354,1245,1246]),bank_widths:new Uint16Array([3846,3846,3846,3846])},flat_file:{x:26921,stack_width:8558,stack_height:5416,bank_widths:new Uint16Array([4972,3586]),shelf_heights:new Uint16Array([5416,5416])}};var l,o,s,r,a,c={menu_open:!0,list_view:!1,resize_handle_current_x:0,resize_handle_new_x:0,resize_handle_current_y:0,resize_handle_new_y:0,vertical_breakpoint:640,vertical_mode:!1};function h(e,t,n,i){const l=new DocumentFragment;for(let e=0,o=n.length;e<o;e++)if(i){const t=m(n[e]);l.appendChild(t)}else{const i=p("li",n[e].name);l.appendChild(i),i.setAttribute("id",t+"-"+e),i.setAttribute("onclick","hl(this);")}document.getElementById(e).appendChild(l)}function d(e,t){const n=viewer.tileSources[e[0]-1].layout;let l=function(e,t){return void 0!==t.uniform_bank_width?{x:t.uniform_bank_width*(e[1]-1)+t.x,width:t.uniform_bank_width}:{x:n(e[1]-1,t.bank_widths)+t.x,width:t.bank_widths[e[1]-1]};function n(e,t){let n=0;for(let i=0;i<e;i++)n+=t[i];return n}}(e,n),o=function(e,t,n){const l=s(e,t);let o=0;for(let t=0,n=e[0]-1;t<n;t++)o+=viewer.tileSources[t].layout.stack_height+i.stack_y_spacer;if(n)return o-=i.zone_highlight_offset,{y:o,height:0};o+=t.stack_height,o-=r(l,e[2]);return{y:o,height:l[e[2]-1]};function s(e,t){return void 0!==t.multiple_shelf_heights&&void 0!==t.multiple_shelf_heights[e[0]]&&void 0!==t.multiple_shelf_heights[e[0]][e[1]]?t.multiple_shelf_heights[e[0]][e[1]]:t.shelf_heights}function r(e,t){let n=0;for(let i=0;i<t;i++)n+=e[i];return n}}(e,n,t);return{x:l.x,y:o.y,width:l.width,height:o.height-4}}function u(e){return document.getElementById(e)}function _(e){return document.createElement(e)}function p(e,t){const n=document.createElement(e);return n.textContent=t,n}function f(e){u("loadingUL").appendChild(p("li",e))}function m(e){const t=document.createElement("li"),n=document.createElement("a");if(n.innerHTML=e.name,""!=e.date&&(n.innerHTML+=" ("+e.date+") "),"!"==e.url.charAt(0)?(n.href="https://archive.org/details/prelinger_library?tab=collection&query="+e.url.substring(1),n.innerHTML+="<span class=c>&#9903;</span> "):n.href="https://archive.org/details/"+e.url+"/mode/thumb?view=theater",e.hasOwnProperty("g")&&(n.innerHTML+="<span class=g>&#9881;</span> "),e.hasOwnProperty("il")){let t="<span class=il>";for(let n=0;n<e.il;n++)t+="&#9830;";t+="</span>",n.innerHTML+=t}return n.setAttribute("target","_blank"),t.appendChild(n),t}function w(){u("resize-handle").style.left="20em",u("menu-container").style.width="20em"}!function(){let e=0;const t=["library_nested.json","periodicals.json","ia.json","special_collections.json","zones_subzones.json"];for(let e=0,i=t.length;e<i;e++)f("Fetching "+t[e]+"..."),fetch("./json-files/"+t[e]).then((e=>e.json())).then((l=>n(t[e],l,i)));function n(t,n,w){switch(f(t+" Loaded."),t){case"library_nested.json":l=n;break;case"periodicals.json":s=n;break;case"special_collections.json":r=n;break;case"ia.json":a=n;break;case"zones_subzones.json":o=n}e++,e==w&&(f("Populating sidebar lists..."),function(){const e=new DocumentFragment;for(let n=0,i=o.length;n<i;n++){const l=o[n],c=_("details"),h=p("summary",l.name);if(e.appendChild(c),c.appendChild(h),h.setAttribute("id","z-"+n.toString()+"-summary"),h.setAttribute("onclick","hl(this);"),"Ephemera"!=l.name&&"Therkleson Collection"!=l.name&&"Flat File"!=l.name){const d=l.sub;for(let u=0,w=d.length;u<w;u++){const g=d[u],y=_("details"),k=p("summary",g.name);if(k.setAttribute("id","s-"+n+"-"+u),k.setAttribute("onclick","hl(this);"),y.appendChild(k),c.appendChild(y),null!=g.p){const v=t("Periodicals (Shelves)",g.p,s,"zp-");y.appendChild(v)}if(null!=g.c){const b=t("Sp. Collections (Shelves)",g.c,r,"zc-");y.appendChild(b)}if(null!=g.i){const z=t("Scanned Items (Ext. Links)",g.i,a,"zi-");y.appendChild(z)}}}function t(e,t,n,i){const l=_("details"),o=p("summary",e),s=_("ul");l.appendChild(o),l.appendChild(s);for(let e=0,l=t.length;e<l;e++){const l=t[e],o=n[l].name;if("zi-"!=i){const e=p("li",o);e.setAttribute("id",i+l),e.setAttribute("onclick","hl(this)"),s.appendChild(e)}else{const e=m(n[l]);s.appendChild(e)}}return l}}document.getElementById("zones-list").appendChild(e),f("Zones/Subzones completed.")}(),h("periodicals-list","p",s,!1),h("sc-list","c",r,!1),h("ia-list","i",a,!0),viewer.addHandler("canvas-click",(function(e){if(e.quick){var t=function(e){const t=r(e);if(0==t)return s("stack"),!1;const n=viewer.tileSources[t-1].layout,l=a(e,n);if(0==l)return s("bank"),!1;const o=c(e,n,viewer.tileSources[t-1].y,t,l);return 0==o?(s("row"),!1):{stack:t,bank:l,row:o};function s(e){console.log("Invalid click location. Found while calculating:",e)}function r(e){for(let t=0;t<i.total_stacks;t++){const n=viewer.tileSources[t];if(e.y>n.y&&e.y<n.y+n.layout.stack_height)return t+1}return!1}function a(e,t){if(e.x<t.x||e.x>t.x+t.stack_width)return!1;if(void 0!==t.uniform_bank_width)return Math.floor((e.x-t.x)/t.uniform_bank_width)+1;{let n=t.x;for(let i=0,l=t.bank_widths.length;i<l;i++){if(e.x>n&&e.x<n+t.bank_widths[i])return i+1;n+=t.bank_widths[i]}return!1}}function c(e,t,n,i,l){const o=r(t,i,l);let s=n+t.stack_height;for(let t=0,n=o.length;t<n;t++)if(s-=o[t],e.y>s)return t+1;return!1;function r(e,t,n){return void 0!==e.multiple_shelf_heights&&void 0!==e.multiple_shelf_heights[t]&&void 0!==e.multiple_shelf_heights[t][n]?e.multiple_shelf_heights[t][n]:e.shelf_heights}}}(viewer.viewport.pointFromPixel(e.position));0!=t&&(function(e){0==c.list_view&&async function(e,t){const n=u(e);function i(e){return new Promise((t=>setTimeout(t,e)))}n.classList.remove(t),await i(1),n.classList.add(t)}("menu-div","click_h2_animation");const t=d(e,!1),n=u("click_shelf_hl");null!=n&&viewer.removeOverlay(n);const i=document.createElement("div");i.id="click_shelf_hl",viewer.addOverlay({element:i,location:new OpenSeadragon.Rect(t.x,t.y,t.width,t.height)})}([t.stack,t.bank,t.row]),function(e,t){const n=new DocumentFragment;try{const e=t.zones[0][0],l=t.zones[0][1],d=p("h4","ZONE:"),u=p("p",o[e].name);if(n.appendChild(d),n.appendChild(u),e<15){const t=p("h4","SUBZONE:"),i=p("p",o[e].sub[l].name);n.appendChild(t),n.appendChild(i)}if(t.zones.length>1){const e=p("h4","OTHER MATERIAL HERE:"),i=_("ul");for(let e=1,n=t.zones.length;e<n;e++){const n=t.zones[e],l=p("li",o[n[0]].name+" >> "+o[n[0]].sub[n[1]].name);i.appendChild(l)}n.appendChild(e),n.appendChild(i)}null!=t.p&&i("PERIODICALS (SHELF):",t.p,s),null!=t.c&&i("COLLECTIONS (SHELF):",t.c,r),clicked_ia_indexes=c(t.zones),0!=clicked_ia_indexes&&h("SCANNED ITEMS (EXT. LINKS):",clicked_ia_indexes,a)}catch(e){n.appendChild(p("h4","WHOOPS! DATA ERROR :P")),n.appendChild(p("p","The site's still working fine, just click on a different shelf. Sorry, my bad!! --Devin ")),console.log(e)}function i(e,t,i){let o=[t.length];for(let e=0,n=t.length;e<n;e++)o[e]=i[t[e]].name;const s=l(e,o);n.appendChild(s[0]),n.appendChild(s[1])}function l(e,t){const n=p("h4",e),i=_("ul");for(let e=0,n=t.length;e<n;e++)i.appendChild(p("li",t[e]));return[n,i]}function c(e){let t=new Set;for(let n=0,i=e.length;n<i;n++){const i=e[n][0],l=e[n][1],s=o[i].sub[l];if(s.hasOwnProperty("i"))for(let e=0,n=s.i.length;e<n;e++)t.add(s.i[e])}return 0!=t.size&&Array.from(t).sort()}function h(e,t,i){const l=p("h4",e),o=_("ul");for(let e=0,n=t.length;e<n;e++)o.appendChild(m(i[t[e]]));n.appendChild(l),n.appendChild(o)}document.getElementById("clicked-info").replaceChildren(n)}(0,l[t.stack-1][t.bank-1][t.row-1]))}})),viewer.addHandler("canvas-double-click",(function(e){viewer.viewport.panTo(viewer.viewport.pointFromPixel(e.position)),viewer.viewport.zoomBy(3)})),f("Sidebars completed."),u("loadingStatus").style.opacity=0,u("loadingStatus").style.visibility="hidden",u("menu-container").style.opacity=1,u("menu-container").style.visibility="visible",u("resize-handle").style.opacity=1,u("resize-handle").style.visibility="visible")}}(),function(){let e=[];for(let n=1,l=i.total_stacks+1,o=0;n<l;n++){const l="dzi-files/STACK-"+n+"-FULL.jpg.dzi",s=t(n);e.push({tileSource:l,x:s.x,y:o,width:s.stack_width,layout:s}),o+=s.stack_height+i.stack_y_spacer}function t(e){switch(e){case 1:return i.stack_one;case 7:return i.ephemera;case 8:return i.therkelson;case 9:return i.flat_file;default:return i.standard}}viewer=OpenSeadragon({id:"osd-container",showNavigator:!1,showNavigationControl:!1,silenceMultiImageWarnings:!0,viewportMargins:{top:20,right:20,bottom:20,left:20},placeholderFillStyle:"#666",blendTime:.25,zoomPerClick:1,zoomPerScroll:1.4,tileSources:e})}(),function(){window.innerWidth<=c.vertical_breakpoint&&(c.vertical_mode=!0);window.addEventListener("resize",(function(){const e=u("menu-container");window.innerWidth<=c.vertical_breakpoint&&0==c.vertical_mode?(c.vertical_mode=!0,e.style.width=null,u("resize-handle").style.display="none"):window.innerWidth>c.vertical_breakpoint&&1==c.vertical_mode&&(c.vertical_mode=!1,e.style.top=null,e.style.height="100%",e.style.width=u("resize-handle").style.left,w(),0==c.menu_open?u("resize-handle").style.display="none":u("resize-handle").style.display="block")}))}(),function(){const e=u("resize-handle"),t=u("menu-container");function n(n){(n=n||window.event).preventDefault(),c.resize_handle_new_x=c.resize_handle_current_x-n.clientX,c.resize_handle_current_x=n.clientX;const i=(l=c.resize_handle_new_x,Math.min(Math.max(e.offsetLeft-l,350),u("zoom-out-button").offsetLeft-40));var l;e.style.left=i+"px",t.style.width=e.style.left}function i(){document.onmouseup=null,document.onmousemove=null}e.addEventListener("dblclick",w),e.onmousedown=function(e){(e=e||window.event).preventDefault(),c.resize_handle_current_x=e.clientX,document.onmouseup=i,document.onmousemove=n}}(),console.log(e,t)};